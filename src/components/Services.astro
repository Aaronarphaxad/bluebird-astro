---
import servicesHome from '../content/services-home.json';

const services = servicesHome as Array<{
	id: string;
	title: string;
	description?: string;
	tags?: string[];
	image?: string;
}>;
const sectionTitle = 'Websites that convert. Plus other ways we help streamline your business.';
---

<section class="services-section relative py-16 sm:py-20 md:py-24 bg-blue-800" aria-label="Our services">
	<div class="max-w-5xl mx-auto px-4 sm:px-6 md:px-12">
		<!-- Section header: title bigger than accordion subtitles -->
		<div class="text-center mb-10 sm:mb-12">
			<p class="font-body text-section-tiny font-medium text-white/70 mb-3">
				Services
			</p>
			<h2 class="font-headline text-section-header font-medium text-white mb-1">
				{sectionTitle}
			</h2>
		</div>

		<!-- Accordion: one open at a time, no arrows; accordion = inner title -->
		<div class="services-accordion space-y-0 border-t border-white/20" data-services-accordion>
			{services.map((service, index) => (
				<details
					class="services-accordion-item border-b border-white/20 group"
					open={index === 0}
					data-service-id={service.id}
					data-service-index={index}
				>
					<summary class="list-none cursor-pointer py-4 sm:py-5 md:py-6 flex items-center justify-between gap-4 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/50 focus-visible:ring-offset-2 focus-visible:ring-offset-blue-800">
						<span class="font-body text-section-inner-title font-medium text-white group-hover:text-white/90 transition-colors">
							{service.title}
						</span>
					</summary>
					<div class="services-accordion-content pb-5 sm:pb-6 md:pb-8 pl-0">
						<div class="flex flex-col sm:flex-row sm:items-start gap-4 sm:gap-6">
							{service.image && (
								<div class="w-full sm:w-24 flex-shrink-0">
									<img
										src={service.image}
										alt={service.title}
										class="w-full aspect-square object-cover rounded-lg"
										loading="lazy"
										width={96}
										height={96}
									/>
								</div>
							)}
							<div class="flex-1 min-w-0">
								{service.description && (
									<p class="font-body text-section-body font-medium text-white/90 leading-relaxed mb-3">
										{service.description}
									</p>
								)}
								{service.tags && service.tags.length > 0 && (
									<div class="flex flex-wrap gap-2 sm:gap-3">
										{service.tags.map((tag) => (
											<span class="font-body text-section-tiny font-medium text-white/70 inline-flex items-center gap-1.5">
												<span class="w-1.5 h-1.5 rounded-full bg-white/60" />
												{tag}
											</span>
										))}
									</div>
								)}
							</div>
						</div>
					</div>
				</details>
			))}
		</div>
	</div>
</section>

<script>
	document.addEventListener('DOMContentLoaded', () => {
		const container = document.querySelector('[data-services-accordion]');
		if (!container) return;
		const detailsList = container.querySelectorAll('details');
		detailsList.forEach((details) => {
			details.addEventListener('toggle', () => {
				if (details.open) {
					detailsList.forEach((d) => {
						if (d !== details) d.open = false;
					});
				}
			});
		});
	});
</script>

<style>
	/* No arrow on details/summary */
	.services-accordion-item summary::-webkit-details-marker,
	.services-accordion-item summary::marker {
		display: none;
	}
	.services-accordion-item summary {
		user-select: none;
	}
</style>

---
// Testimonials - Simple and modern design
---

<section class="relative py-46 sm:py-32 md:py-50 px-4 sm:px-6 lg:px-8 bg-bg overflow-hidden">
	<div class="relative max-w-5xl mx-auto">
		<!-- Section header -->
		<div class="text-center mb-10 sm:mb-12" data-scroll-reveal>
			<p class="font-body text-section-tiny font-medium text-textMuted mb-3">
				Testimonials
			</p>
			<h2 class="font-headline text-section-header font-medium text-text mb-1">
				What our clients say
			</h2>
		</div>
		
		<!-- Testimonial cards - horizontal scroll on mobile, grid on md+ -->
		<div class="testimonials-container flex md:grid md:grid-cols-3 gap-5 sm:gap-6 overflow-x-auto md:overflow-visible snap-x snap-mandatory pb-4 md:pb-0 -mx-4 px-4 md:mx-0 md:px-0">
			<!-- Testimonial 1 -->
			<div class="testimonial-card flex-shrink-0 w-[85vw] sm:w-[70vw] md:w-auto snap-center p-5 sm:p-6 bg-white border border-accentSubtle/30 rounded-2xl shadow-md hover:shadow-lg transition-all duration-300">
				<!-- Quote icon - smaller -->
				<div class="w-7 h-7 rounded-lg bg-accent/10 flex items-center justify-center mb-4">
					<svg class="w-3.5 h-3.5 text-accent" fill="currentColor" viewBox="0 0 24 24">
						<path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z"/>
					</svg>
				</div>
				
				<!-- Quote text - smaller -->
				<p class="font-body text-section-body font-medium text-textMuted leading-relaxed mb-5">
					"Working with Bluebird was a game-changer. The website they built has significantly increased our conversions."
				</p>
				
				<!-- Author -->
				<div class="flex items-center gap-3">
					<div class="w-9 h-9 rounded-full bg-gradient-to-br from-accent to-blue-400 flex items-center justify-center">
						<span class="font-body text-section-tiny font-medium text-white">SK</span>
					</div>
					<div>
						<div class="font-body text-section-body font-medium text-text">Sarah Kim</div>
						<div class="font-body text-section-tiny font-medium text-textMuted">CEO, TechStart</div>
					</div>
				</div>
			</div>
			
			<!-- Testimonial 2 -->
			<div class="testimonial-card flex-shrink-0 w-[85vw] sm:w-[70vw] md:w-auto snap-center p-5 sm:p-6 bg-white border border-accentSubtle/30 rounded-2xl shadow-md hover:shadow-lg transition-all duration-300">
				<div class="w-7 h-7 rounded-lg bg-purple-100 flex items-center justify-center mb-4">
					<svg class="w-3.5 h-3.5 text-purple-600" fill="currentColor" viewBox="0 0 24 24">
						<path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z"/>
					</svg>
				</div>
				
				<p class="font-body text-section-body font-medium text-textMuted leading-relaxed mb-5">
					"The team delivered exactly what we neededâ€”on time and within budget. Amazing feedback from our customers."
				</p>
				
				<div class="flex items-center gap-3">
					<div class="w-9 h-9 rounded-full bg-gradient-to-br from-purple-500 to-pink-400 flex items-center justify-center">
						<span class="font-body text-section-tiny font-medium text-white">MJ</span>
					</div>
					<div>
						<div class="font-body text-section-body font-medium text-text">Michael Johnson</div>
						<div class="font-body text-section-tiny font-medium text-textMuted">Founder, GrowthLab</div>
					</div>
				</div>
			</div>
			
			<!-- Testimonial 3 -->
			<div class="testimonial-card flex-shrink-0 w-[85vw] sm:w-[70vw] md:w-auto snap-center p-5 sm:p-6 bg-white border border-accentSubtle/30 rounded-2xl shadow-md hover:shadow-lg transition-all duration-300">
				<div class="w-7 h-7 rounded-lg bg-emerald-100 flex items-center justify-center mb-4">
					<svg class="w-3.5 h-3.5 text-emerald-600" fill="currentColor" viewBox="0 0 24 24">
						<path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z"/>
					</svg>
				</div>
				
				<p class="font-body text-section-body font-medium text-textMuted leading-relaxed mb-5">
					"Professional, creative, and incredibly responsive. They understood our vision and brought it to life beautifully."
				</p>
				
				<div class="flex items-center gap-3">
					<div class="w-9 h-9 rounded-full bg-gradient-to-br from-emerald-500 to-teal-400 flex items-center justify-center">
						<span class="font-body text-section-tiny font-medium text-white">AR</span>
					</div>
					<div>
						<div class="font-body text-section-body font-medium text-text">Amanda Rodriguez</div>
						<div class="font-body text-section-tiny font-medium text-textMuted">Marketing Director</div>
					</div>
				</div>
			</div>
		</div>
		
		<!-- Scroll indicators for mobile -->
		<div class="flex justify-center gap-2 mt-4 md:hidden">
			<div class="scroll-dot w-2 h-2 rounded-full bg-accent/60"></div>
			<div class="scroll-dot w-2 h-2 rounded-full bg-accent/30"></div>
			<div class="scroll-dot w-2 h-2 rounded-full bg-accent/30"></div>
		</div>
	</div>
</section>

<style>
	/* Hide scrollbar but keep functionality */
	.testimonials-container {
		scrollbar-width: none;
		-ms-overflow-style: none;
	}
	.testimonials-container::-webkit-scrollbar {
		display: none;
	}
</style>

<script>
	// Update scroll indicators based on scroll position
	// Optimized to prevent forced reflows by batching reads and using requestAnimationFrame
	const container = document.querySelector('.testimonials-container');
	const dots = document.querySelectorAll('.scroll-dot');
	
	if (container && dots.length) {
		let rafId: number | null = null;
		let cachedCardWidth = 0;
		const gap = 20; // gap-5 = 1.25rem = 20px
		
		// Cache card width once on load
		const card = container.querySelector('.testimonial-card') as HTMLElement | null;
		if (card) {
			cachedCardWidth = card.clientWidth;
		}
		
		// Re-cache on resize (debounced)
		let resizeTimeout: ReturnType<typeof setTimeout>;
		window.addEventListener('resize', () => {
			clearTimeout(resizeTimeout);
			resizeTimeout = setTimeout(() => {
				if (card) {
					cachedCardWidth = card.clientWidth;
				}
			}, 150);
		}, { passive: true });
		
		container.addEventListener('scroll', () => {
			// Cancel any pending updates
			if (rafId !== null) {
				cancelAnimationFrame(rafId);
			}
			
			// Batch read and write in requestAnimationFrame
			rafId = requestAnimationFrame(() => {
				// Read scroll position (this is cheap, no layout recalculation)
				const scrollLeft = container.scrollLeft;
				const activeIndex = Math.round(scrollLeft / (cachedCardWidth + gap));
				
				// Batch all DOM writes
				dots.forEach((dot, index) => {
					if (index === activeIndex) {
						dot.classList.remove('bg-accent/30');
						dot.classList.add('bg-accent/60');
					} else {
						dot.classList.remove('bg-accent/60');
						dot.classList.add('bg-accent/30');
					}
				});
				
				rafId = null;
			});
		}, { passive: true });
	}
</script>
